<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="coglasso">
<title>Reconstructing mult-omics networks with coglasso • coglasso</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reconstructing mult-omics networks with coglasso">
<meta property="og:description" content="coglasso">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">coglasso</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/coglasso.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/manuscript.html">Reproduction of manuscript's results</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DrQuestion/coglasso/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Reconstructing mult-omics networks with coglasso</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DrQuestion/coglasso/blob/HEAD/vignettes/coglasso.Rmd" class="external-link"><code>vignettes/coglasso.Rmd</code></a></small>
      <div class="d-none name"><code>coglasso.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette illustrates the basic usage of the package
<code>coglasso</code> to reconstruct a multi-omics network. The package
implements and R interface to <em>collaborative graphical lasso</em>, a
network estimation algorithm based on <em>graphical lasso</em> (<a href="#ref">Friedman, Hastie and Tibshirani, 2008</a>) and
<em>collaborative regression</em> (<a href="#ref">Gross and Tibshirani,
2015</a>)</p>
<p>Let us first attach coglasso.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DrQuestion/coglasso" class="external-link">coglasso</a></span><span class="op">)</span></span></code></pre></div>
<p>We then choose the multi-omics data set to use. The
<code>coglasso</code> package offers three alternative version of a
transcriptomics and metabolomics data set. We will use
<code>multi_omics_sd_small</code>. For further explanation about all the
multi-omics data sets see <code><a href="../reference/multi_omics_sd.html">help(multi_omics_sd)</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">multi_omics_sd_small</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Cirbp"       "Hspa5"       "Spry4"       "P4ha1"       "Spred1"     </span></span>
<span><span class="co">#&gt;  [6] "Creld2"      "Pdia6"       "Hsp90b1"     "Hsph1"       "Manf"       </span></span>
<span><span class="co">#&gt; [11] "Pdia3"       "Dnajb11"     "Gfod1"       "Dnajc3"      "BC004004"   </span></span>
<span><span class="co">#&gt; [16] "Stip1"       "Phe"         "Trp"         "Putrescine"  "PC aa C36:3"</span></span>
<span><span class="co">#&gt; [21] "PC ae C32:2"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">multi_omics_sd_small</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 30</span></span></code></pre></div>
<p>This smaller version of <code>multi_omics_sd</code> has 21 variables,
16 genes and 5 metabolites, and 30 samples. We can directly proceed with
network reconstruction.</p>
</div>
<div class="section level2">
<h2 id="multi-omics-network-reconstruction">Multi-omics network reconstruction<a class="anchor" aria-label="anchor" href="#multi-omics-network-reconstruction"></a>
</h2>
<p>Our objective is to reconstruct a network from this data set using
<em>collaborative graphical lasso</em>. To do so with the package
<code>coglasso</code>, we mainly call two functions. First, we use
<code><a href="../reference/coglasso.html">coglasso()</a></code> to estimate a network for every combination of
hyperparameters we want to explore. Following this, we call
<code><a href="../reference/stars_coglasso.html">stars_coglasso()</a></code> to select the best combination of
hyperparameters using stability selection.</p>
<p>The usual application of <code><a href="../reference/coglasso.html">coglasso()</a></code> requires to give an
input data set to the argument <code>data</code>, the number of
variables of the the first type to <code>pX</code>, and hyperparameter
settings. Collaborative graphical lasso has three hyperparameters: <span class="math inline">\(λ_w\)</span>, penalizing “within” same-type
interactions, <span class="math inline">\(λ_b\)</span> penalizing
“between” different-type interactions, and <span class="math inline">\(c\)</span>, the weight of the collaborative term.
In this vignette we choose to explore 30 possible penalty values for
both “within” and “between” penalties, and three possible collaboration
values. We do so by setting both <code>nlambda_w</code> and
<code>nlambda_b</code> to 30, and by setting <code>nc</code> to 3. We
also decide to focus our search to the sparse side of possible networks,
by setting higher minimum ratios between the smallest (least penalizing)
and the largest (most penalizing) penalty explored. While the default
value of these parameters is 0.1, we decide to set the minimum ratio to
0.7 for <span class="math inline">\(λ_w\)</span> and to 0.5 for <span class="math inline">\(λ_b\)</span>. For further explanation on other
arguments of <code><a href="../reference/coglasso.html">coglasso()</a></code> and how to use them, please see
<code><a href="../reference/coglasso.html">help(coglasso)</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/coglasso.html">coglasso</a></span><span class="op">(</span><span class="va">multi_omics_sd_small</span>, pX <span class="op">=</span> <span class="fl">16</span>, nlambda_w <span class="op">=</span> <span class="fl">30</span>, nlambda_b <span class="op">=</span> <span class="fl">30</span>, nc <span class="op">=</span> <span class="fl">3</span>, lambda_w_min_ratio <span class="op">=</span> <span class="fl">0.7</span>, lambda_b_min_ratio <span class="op">=</span> <span class="fl">0.5</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To see the explored paramaters:</span></span>
<span><span class="va">cg</span><span class="op">$</span><span class="va">lambda_w</span></span>
<span><span class="co">#&gt;  [1] 0.9136980 0.9025291 0.8914968 0.8805993 0.8698350 0.8592023 0.8486996</span></span>
<span><span class="co">#&gt;  [8] 0.8383253 0.8280777 0.8179555 0.8079569 0.7980806 0.7883250 0.7786887</span></span>
<span><span class="co">#&gt; [15] 0.7691702 0.7597680 0.7504807 0.7413070 0.7322454 0.7232945 0.7144531</span></span>
<span><span class="co">#&gt; [22] 0.7057198 0.6970932 0.6885721 0.6801551 0.6718410 0.6636285 0.6555165</span></span>
<span><span class="co">#&gt; [29] 0.6475036 0.6395886</span></span>
<span><span class="va">cg</span><span class="op">$</span><span class="va">lambda_b</span></span>
<span><span class="co">#&gt;  [1] 0.9136980 0.8921181 0.8710478 0.8504752 0.8303884 0.8107761 0.7916270</span></span>
<span><span class="co">#&gt;  [8] 0.7729302 0.7546749 0.7368508 0.7194477 0.7024556 0.6858648 0.6696659</span></span>
<span><span class="co">#&gt; [15] 0.6538496 0.6384068 0.6233288 0.6086068 0.5942326 0.5801979 0.5664946</span></span>
<span><span class="co">#&gt; [22] 0.5531150 0.5400514 0.5272963 0.5148425 0.5026828 0.4908104 0.4792183</span></span>
<span><span class="co">#&gt; [29] 0.4679000 0.4568490</span></span>
<span><span class="va">cg</span><span class="op">$</span><span class="va">c</span></span>
<span><span class="co">#&gt; [1] 10.000000  3.162278  1.000000</span></span></code></pre></div>
<p>To select the best combination of hyperparameters, we will use
<code><a href="../reference/stars_coglasso.html">stars_coglasso()</a></code>. This function implements a
<em>coglasso</em>-adapted version of <em>StARS</em>, the stability
selection method developed by Liu, Roeder and Wasserman (<a href="#ref">2010</a>). The usual application of
<code><a href="../reference/stars_coglasso.html">stars_coglasso()</a></code> uses the default options of the function,
whose only required input is the object resulting from
<code><a href="../reference/coglasso.html">coglasso()</a></code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel_cg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stars_coglasso.html">stars_coglasso</a></span><span class="op">(</span><span class="va">cg</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To see the selected parameters:</span></span>
<span><span class="va">sel_cg</span><span class="op">$</span><span class="va">sel_lambda_w</span></span>
<span><span class="co">#&gt; [1] 0.913698</span></span>
<span><span class="va">sel_cg</span><span class="op">$</span><span class="va">sel_lambda_b</span></span>
<span><span class="co">#&gt; [1] 0.4679</span></span>
<span><span class="va">sel_cg</span><span class="op">$</span><span class="va">sel_c</span></span>
<span><span class="co">#&gt; [1] 3.162278</span></span></code></pre></div>
<p>With this we have selected the combination of hyperparameters
yielding the most stable, yet sparse <em>coglasso</em> network. The
adjacency matrix of the selected network is stored in the object
<code>sel_cg$sel_adj</code>. We can use this matrix to display the
selected network with the R package <code>igraph</code>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># To create the igraph object from the selected adjacency matrix:</span></span>
<span><span class="va">sel_graph</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/graph_from_adjacency_matrix.html" class="external-link">graph.adjacency</a></span><span class="op">(</span><span class="va">sel_cg</span><span class="op">$</span><span class="va">sel_adj</span>, mode <span class="op">=</span> <span class="st">"undirected"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Setting some graphical parameters and removing disconnected nodes from the graph</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">sel_graph</span><span class="op">)</span><span class="op">$</span><span class="va">label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">multi_omics_sd_small</span><span class="op">)</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">sel_graph</span><span class="op">)</span><span class="op">$</span><span class="va">color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#00ccff"</span>, <span class="fl">16</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#ff9999"</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">sel_graph</span><span class="op">)</span><span class="op">$</span><span class="va">frame.color</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#002060"</span>, <span class="fl">16</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"#800000"</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">sel_graph</span><span class="op">)</span><span class="op">$</span><span class="va">frame.width</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/V.html" class="external-link">V</a></span><span class="op">(</span><span class="va">sel_graph</span><span class="op">)</span><span class="op">$</span><span class="va">size</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></span>
<span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/E.html" class="external-link">E</a></span><span class="op">(</span><span class="va">sel_graph</span><span class="op">)</span><span class="op">$</span><span class="va">width</span> <span class="op">&lt;-</span> <span class="fl">2</span></span>
<span></span>
<span><span class="va">lo</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/layout_with_fr.html" class="external-link">layout_with_fr</a></span><span class="op">(</span><span class="va">sel_graph</span><span class="op">)</span></span>
<span><span class="va">diconnected</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/degree.html" class="external-link">degree</a></span><span class="op">(</span><span class="va">sel_graph</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">sel_graph2</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://r.igraph.org/reference/delete_vertices.html" class="external-link">delete.vertices</a></span><span class="op">(</span><span class="va">sel_graph</span>, <span class="va">diconnected</span><span class="op">)</span></span>
<span><span class="va">lo2</span> <span class="op">&lt;-</span> <span class="va">lo</span><span class="op">[</span><span class="op">-</span><span class="va">diconnected</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Plotting</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sel_graph2</span>, layout <span class="op">=</span> <span class="va">lo2</span><span class="op">)</span></span></code></pre></div>
<p><img src="coglasso_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="ref">References<a class="anchor" aria-label="anchor" href="#ref"></a>
</h2>
<p>Friedman, J., Hastie, T., &amp; Tibshirani, R. (2008). Sparse inverse
covariance estimation with the graphical lasso. <em>Biostatistics</em>,
9(3), 432–441. <a href="https://doi.org/10.1093/biostatistics/kxm045" class="external-link uri">https://doi.org/10.1093/biostatistics/kxm045</a></p>
<p>Gross, S. M., &amp; Tibshirani, R. (2015). Collaborative regression.
<em>Biostatistics</em>, 16(2), 326–338. <a href="https://doi.org/10.1093/biostatistics/kxu047" class="external-link uri">https://doi.org/10.1093/biostatistics/kxu047</a></p>
<p>Liu, H., Roeder, K., &amp; Wasserman, L. (2010). Stability Approach
to Regularization Selection (StARS) for High Dimensional Graphical
Models (arXiv:1006.3316). <em>arXiv.</em> <a href="https://doi.org/10.48550/arXiv.1006.3316" class="external-link uri">https://doi.org/10.48550/arXiv.1006.3316</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Alessio Albanese.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
