<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Reconstructing mult-omics networks with coglasso • coglasso</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Reconstructing mult-omics networks with coglasso">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">coglasso</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/coglasso.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/manuscript.html">Reproduction of manuscript's results</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/DrQuestion/coglasso/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Reconstructing mult-omics networks with coglasso</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DrQuestion/coglasso/blob/main/vignettes/coglasso.Rmd" class="external-link"><code>vignettes/coglasso.Rmd</code></a></small>
      <div class="d-none name"><code>coglasso.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette illustrates the basic usage of the coglasso package to
reconstruct a multi-omics network. The package implements an R interface
to <em>collaborative graphical lasso</em> (<a href="#ref">Albanese,
Kohlen and Behrouzi, 2024</a>), a network estimation algorithm based on
<em>graphical lasso</em> (<a href="#ref">Friedman, Hastie and
Tibshirani, 2008</a>) and <em>collaborative regression</em> (<a href="#ref">Gross and Tibshirani, 2015</a>)</p>
<p>Let us first attach coglasso.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DrQuestion/coglasso" class="external-link">coglasso</a></span><span class="op">)</span></span></code></pre></div>
<p>We then choose the multi-omics data set to use. The coglasso package
offers three alternative version of a transcriptomics and metabolomics
data set. We will use <code>multi_omics_sd_small</code>. For further
explanation about the available multi-omics data sets see
<code><a href="../reference/multi_omics_sd.html">help(multi_omics_sd)</a></code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">multi_omics_sd_small</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "Cirbp"       "Hspa5"       "P4ha1"       "Spred1"      "Creld2"     </span></span>
<span><span class="co">#&gt;  [6] "Pdia6"       "Hsp90b1"     "Hsph1"       "Manf"        "Pdia3"      </span></span>
<span><span class="co">#&gt; [11] "Dnajb11"     "Dnajc3"      "BC004004"    "Stip1"       "Phe"        </span></span>
<span><span class="co">#&gt; [16] "Trp"         "Putrescine"  "PC aa C36:3" "PC ae C32:2"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">multi_omics_sd_small</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 30</span></span></code></pre></div>
<p>This smaller version of <code>multi_omics_sd</code> has 19 variables,
14 genes and 5 metabolites, and 30 samples. We can directly proceed with
network reconstruction.</p>
</div>
<div class="section level2">
<h2 id="multi-omics-network-reconstruction">Multi-omics network reconstruction<a class="anchor" aria-label="anchor" href="#multi-omics-network-reconstruction"></a>
</h2>
<p>Our objective is to reconstruct a network from this data set using
<em>collaborative graphical lasso</em>. To do so with the coglasso
package, we mainly call a function: <code><a href="../reference/bs.html">bs()</a></code>. This function
first estimates a network for every combination of hyperparameters we
want to explore, then it selects the best combination according to the
chosen model selection method.</p>
<p>The usual application of <code><a href="../reference/bs.html">bs()</a></code> requires to give an input
data set to the argument <code>data</code>, the number of variables of
the various omics layers <code>p</code>, and the hyperparameter
settings. Collaborative graphical lasso has three hyperparameters:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>w</mi></msub><annotation encoding="application/x-tex">λ_w</annotation></semantics></math>,
penalizing “within” same-type interactions,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>b</mi></msub><annotation encoding="application/x-tex">λ_b</annotation></semantics></math>
penalizing “between” different-type interactions, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>c</mi><annotation encoding="application/x-tex">c</annotation></semantics></math>,
the weight of the collaborative term. In this vignette we choose to
explore 15 possible penalty values for both “within” and “between”
penalties, and three possible collaboration values. We do so by setting
both <code>nlambda_w</code> and <code>nlambda_b</code> to 15, and by
setting <code>nc</code> to 3. We also decide to focus our search to the
sparse side of possible “within” networks. We achieve this by setting to
a fixed value the ratio between the smallest (least penalizing) and the
largest (most penalizing)
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>w</mi></msub><annotation encoding="application/x-tex">λ_w</annotation></semantics></math>
explored. While the default value of these parameter is 0.1 for both
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>w</mi></msub><annotation encoding="application/x-tex">λ_w</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>b</mi></msub><annotation encoding="application/x-tex">λ_b</annotation></semantics></math>,
we decide to set the minimum ratio to 0.6 for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>λ</mi><mi>w</mi></msub><annotation encoding="application/x-tex">λ_w</annotation></semantics></math>.</p>
<p>It is also possible to set options for the model selection procedure,
if one does not want to enjoy the comfort of the default behaviour. To
select the best combination of hyperparameters, we will set
<code>method</code> to “xestars” (which is the default behaviour). This
implements <em>eXtended Efficient StARS</em>, a significantly faster
version of <em>eXtended StARS</em> (<em>XStARS</em>, <a href="#ref">Albanese, Kohlen and Behrouzi, 2024</a>). <em>XEStARS</em>
and <em>XStARS</em> are a coglasso-adapted version of <em>StARS</em>,
the stability selection method developed by Liu, Roeder and Wasserman
(<a href="#ref">2010</a>). The suggested application of
<code><a href="../reference/bs.html">bs()</a></code> uses the default options of the function. For further
explanation on other selection methods available, and on other arguments
of <code><a href="../reference/bs.html">bs()</a></code> and how to use them, please see
<code><a href="../reference/bs.html">help(bs)</a></code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel_cg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bs.html">bs</a></span><span class="op">(</span></span>
<span>  <span class="va">multi_omics_sd_small</span>,</span>
<span>  p <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>  nlambda_w <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  nlambda_b <span class="op">=</span> <span class="fl">15</span>,</span>
<span>  nc <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  lambda_w_min_ratio <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># To see information on the network estimation and selection:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sel_cg</span><span class="op">)</span></span>
<span><span class="co">#&gt; Selected network estimated with collaborative graphical lasso</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The call was:</span></span>
<span><span class="co">#&gt; bs(data = multi_omics_sd_small, p = c(14, 5), nlambda_w = 15, </span></span>
<span><span class="co">#&gt;     nlambda_b = 15, nc = 3, lambda_w_min_ratio = 0.6, verbose = FALSE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The model selection method was:</span></span>
<span><span class="co">#&gt; xestars</span></span>
<span><span class="co">#&gt; The density of the selected network is:</span></span>
<span><span class="co">#&gt; 0.04678363</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Networks are made of 2 omics layers, for a total of 19 nodes</span></span>
<span><span class="co">#&gt; For each layer they have: 14 and 5 nodes, respectively</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The selected value for lambda within is:</span></span>
<span><span class="co">#&gt; 0.8494</span></span>
<span><span class="co">#&gt; The selected value for lambda between is:</span></span>
<span><span class="co">#&gt; 0.5578</span></span>
<span><span class="co">#&gt; The selected value for c is:</span></span>
<span><span class="co">#&gt; 3.1623</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The total number of hyperparameter combinations explored was:</span></span>
<span><span class="co">#&gt; 675</span></span>
<span><span class="co">#&gt; The values explored for lambda within were:</span></span>
<span><span class="co">#&gt; 0.9137, 0.881, 0.8494, 0.819, 0.7896, 0.7613, 0.734, 0.7077, 0.6824, 0.6579, 0.6344, 0.6116, 0.5897, 0.5686, 0.5482</span></span>
<span><span class="co">#&gt; The values explored for lambda between were:</span></span>
<span><span class="co">#&gt; 0.9137, 0.7751, 0.6576, 0.5578, 0.4732, 0.4015, 0.3406, 0.2889, 0.2451, 0.2079, 0.1764, 0.1497, 0.127, 0.1077, 0.0914</span></span>
<span><span class="co">#&gt; The values explored for c were:</span></span>
<span><span class="co">#&gt; 10, 3.1623, 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Plot the selected network with:</span></span>
<span><span class="co">#&gt; plot(sel_cg)</span></span></code></pre></div>
<p>With this we have fast selected the combination of hyperparameters
yielding the most stable, yet sparse coglasso network. We can directly
plot the selected network with:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sel_cg</span><span class="op">)</span></span></code></pre></div>
<p><img src="coglasso_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="ref">References<a class="anchor" aria-label="anchor" href="#ref"></a>
</h2>
<p>Albanese, A., Kohlen, W., &amp; Behrouzi, P. (2024). Collaborative
graphical lasso (arXiv:2403.18602). <em>arXiv</em> <a href="https://doi.org/10.48550/arXiv.2403.18602" class="external-link uri">https://doi.org/10.48550/arXiv.2403.18602</a></p>
<p>Friedman, J., Hastie, T., &amp; Tibshirani, R. (2008). Sparse inverse
covariance estimation with the graphical lasso. <em>Biostatistics</em>,
9(3), 432–441. <a href="https://doi.org/10.1093/biostatistics/kxm045" class="external-link uri">https://doi.org/10.1093/biostatistics/kxm045</a></p>
<p>Gross, S. M., &amp; Tibshirani, R. (2015). Collaborative regression.
<em>Biostatistics</em>, 16(2), 326–338. <a href="https://doi.org/10.1093/biostatistics/kxu047" class="external-link uri">https://doi.org/10.1093/biostatistics/kxu047</a></p>
<p>Liu, H., Roeder, K., &amp; Wasserman, L. (2010). Stability Approach
to Regularization Selection (StARS) for High Dimensional Graphical
Models (arXiv:1006.3316). <em>arXiv</em> <a href="https://doi.org/10.48550/arXiv.1006.3316" class="external-link uri">https://doi.org/10.48550/arXiv.1006.3316</a></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alessio Albanese, Pariya Behrouzi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
