<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content='select_coglasso() selects the best combination of hyperparameters given to
coglasso() according to the selected model selection method. The three
availble options that can be set for the argument method are  "xstars",
"xestars" and "ebic".'><title>Select the best coglasso network — select_coglasso • coglasso</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Select the best coglasso network — select_coglasso"><meta property="og:description" content='select_coglasso() selects the best combination of hyperparameters given to
coglasso() according to the selected model selection method. The three
availble options that can be set for the argument method are  "xstars",
"xestars" and "ebic".'><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">coglasso</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/coglasso.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/manuscript.html">Reproduction of manuscript's results</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DrQuestion/coglasso/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Select the best <code>coglasso</code> network</h1>
      <small class="dont-index">Source: <a href="https://github.com/DrQuestion/coglasso/blob/HEAD/R/select_coglasso.R" class="external-link"><code>R/select_coglasso.R</code></a></small>
      <div class="d-none name"><code>select_coglasso.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>select_coglasso()</code> selects the best combination of hyperparameters given to
<code><a href="coglasso.html">coglasso()</a></code> according to the selected model selection method. The three
availble options that can be set for the argument <code>method</code> are  "xstars",
"xestars" and "ebic".</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">select_coglasso</span><span class="op">(</span></span>
<span>  <span class="va">coglasso_obj</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"xestars"</span>,</span>
<span>  stars_thresh <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  stars_subsample_ratio <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rep_num <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  old_sampling <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  light <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ebic_gamma <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>coglasso_obj</dt>
<dd><p>The object of <code>S3</code> class <code>coglasso</code> returned by <code><a href="coglasso.html">coglasso()</a></code>.</p></dd>


<dt>method</dt>
<dd><p>The model selection method to select the best combination of
hyperparameters. The available options are "xstars", "xestars" and "eBIC".
Defaults to "xestars".</p></dd>


<dt>stars_thresh</dt>
<dd><p>The threshold set for variability of the explored
networks at each iteration of the algorithm. The \(\lambda_w\) or the
\(\lambda_b\) associated to the most stable network before the threshold
is overcome is selected.</p></dd>


<dt>stars_subsample_ratio</dt>
<dd><p>The proportion of samples in the multi-omics
data set to be randomly subsampled to estimate the variability of the
network under the given hyperparameters setting. Defaults to 80% when the
number of samples is smaller than 144, otherwise it defaults to
\(\frac{10}{n}\sqrt{n}\).</p></dd>


<dt>rep_num</dt>
<dd><p>The amount of subsamples of the multi-omics data set used to
estimate the variability of the network under the given hyperparameters
setting. Defaults to 20.</p></dd>


<dt>max_iter</dt>
<dd><p>The greatest number of times the algorithm is allowed to
choose a new best \(\lambda_w\). Defaults to 10.</p></dd>


<dt>old_sampling</dt>
<dd><p>If set to TRUE <code><a href="xestars.html">xestars()</a></code> performs the same subsampling
<code><a href="xstars.html">xstars()</a></code> would. Makes a difference with bigger data sets, where computing
a correlation matrix could take significantly longer. Defaults to FALSE.</p></dd>


<dt>light</dt>
<dd><p>If set TRUE the "merged" matrixes recording average variability
of each edge are not stored and the algorithm is more memory efficient.
Defaults to TRUE.</p></dd>


<dt>ebic_gamma</dt>
<dd><p>The \(\gamma\) tuning parameter for <em>eBIC</em> selection, to set
between 0 and 1. When set to 0 one has the standard <em>BIC</em>. Defaults to 0.5.</p></dd>


<dt>verbose</dt>
<dd><p>Print information regarding the progress of the selection
procedure on the console.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>select_coglasso()</code> returns an object of <code>S3</code> class <code>select_coglasso</code></p>


<p>containing the results of the
selection procedure, built upon an object of <code>S3</code> class <code>coglasso</code>. Some
output elements depend on the chosen model selection method. <br></p>


<p>These elements are returned by all methods:</p><ul><li><p>... are the same elements returned by <code><a href="coglasso.html">coglasso()</a></code>.</p></li>
<li><p><code>sel_index_c</code>, <code>sel_index_lw</code> and <code>sel_index_lb</code> are the indexes of the
final selected parameters \(c\), \(\lambda_w\) and \(\lambda_b\)
leading to the most stable sparse network.</p></li>
<li><p><code>sel_c</code>, <code>sel_lambda_w</code> and <code>sel_lambda_b</code> are the final selected
parameters \(c\), \(\lambda_w\) and \(\lambda_b\) leading to the most
stable sparse network.</p></li>
<li><p><code>sel_adj</code> is the adjacency matrix of the final selected network.</p></li>
<li><p><code>sel_density</code> is the density of the final selected network.</p></li>
<li><p><code>sel_icov</code> is the inverse covariance matrix of the final selected network.</p></li>
<li><p><code>call</code> is the matched call.</p></li>
<li><p><code>method</code> is the chosen model selection method.</p></li>
</ul><p>These are the additional elements returned when choosing "xestars":</p><ul><li><p><code>opt_adj</code> is a list of the adjacency matrices finally selected for each
\(c\) parameter explored.</p></li>
<li><p><code>opt_variability</code> is a numerical vector containing the variabilities
associated to the adjacency matrices in <code>opt_adj</code>.</p></li>
<li><p><code>opt_index_lw</code> and <code>opt_index_lb</code> are integer vectors containing the
index of the selected \(\lambda_w\)s (or \(\lambda_b\)s) for each
\(c\) parameters explored.</p></li>
<li><p><code>opt_lambda_w</code> and <code>opt_lambda_b</code> are vectors containing the selected
\(\lambda_w\)s (or \(\lambda_b\)s) for each \(c\) parameters
explored.</p></li>
<li><p><code>merge_lw</code> and <code>merge_lb</code> are returned only if <code>light</code> is set to FALSE.
They are lists with as many elements as the number of
\(c\) parameters explored. Every element is a "merged" adjacency matrix,
the average of all the adjacency matrices estimated  for those specific
\(c\) and the selected \(\lambda_w\) (or \(\lambda_b\)) values
across all the subsampling in the last path explored before convergence,
the one when the final combination of \(\lambda_w\) and \(\lambda_b\)
is selected for the given \(c\) value.</p></li>
</ul><p>These are the additional elements returned when choosing "xstars":</p><ul><li><p><code>merge_lw</code> and <code>merge_lb</code> are lists with as many elements as the number of
\(c\) parameters explored. Every element is in turn a list of as many
matrices as the number of \(\lambda_w\) (or \(\lambda_b\)) values
explored. Each matrix is the "merged" adjacency matrix, the average of all
the adjacency matrices estimated  for those specific \(c\) and
\(\lambda_w\) (or \(\lambda_b\)) values across all the subsampling in
the last path explored before convergence, the one when the final
combination of \(\lambda_w\) and \(\lambda_b\) is selected for the
given \(c\) value.</p></li>
<li><p><code>variability_lw</code> and <code>variability_lb</code> are lists with as many elements as
the number of \(c\) parameters explored. Every element is a numeric
vector of as many items as the number of \(\lambda_w\) (or
\(\lambda_b\)) values explored. Each item is the variability of the
network estimated for those specific \(c\) and \(\lambda_w\) (or
\(\lambda_b\)) values in the last path explored before convergence, the
one when the final combination of \(\lambda_w\) and \(\lambda_b\) is
selected for the given \(c\) value.</p></li>
<li><p><code>opt_adj</code> is a list of the adjacency matrices finally selected for each
\(c\) parameter explored.</p></li>
<li><p><code>opt_variability</code> is a numerical vector containing the variabilities
associated to the adjacency matrices in <code>opt_adj</code>.</p></li>
<li><p><code>opt_index_lw</code> and <code>opt_index_lb</code> are integer vectors containing the
index of the selected \(\lambda_w\)s (or \(\lambda_b\)s) for each
\(c\) parameters explored.</p></li>
<li><p><code>opt_lambda_w</code> and <code>opt_lambda_b</code> are vectors containing the selected
\(\lambda_w\)s (or \(\lambda_b\)s) for each \(c\) parameters
explored.</p></li>
</ul><p>These are the additional elements returned when choosing "ebic":</p><ul><li><p><code>ebic_scores</code> is a numerical vector containing the eBIC scores for all the
hyperparameter combination.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>select_coglasso()</code> provides three model selection strategies:</p><ul><li><p>"xstars" uses <em>eXtended StARS</em> (<em>XStARS</em>) selecting the most stable, yet sparse
network. Stability is computed upon network estimation from multiple subsamples of the
multi-omics data set, allowing repetition. Subsamples are collected for a
fixed amount of times (<code>rep_num</code>), and with a fixed proportion of the total
number of samples (<code>stars_subsample_ratio</code>). See <code><a href="xstars.html">xstars()</a></code> for more
information on the methodology.</p></li>
<li><p>"xestars" uses <em>eXtended Efficient StARS</em> (<em>XEStARS</em>), a significantly
faster and memory-effcient version of <em>XStARS</em>. It could produce marginally
different results to "xstars" due to a different sampling strategy. See
<code><a href="xestars.html">xestars()</a></code> for more information on the methodology.</p></li>
<li><p>"ebic" uses the <em>extended Bayesian Information</em>
<em>Criterion</em> (<em>eBIC</em>) selecting the network that minimizes it. <code>gamma</code> sets the
wait given to the extended component, turning the model selection method to
the standard <em>BIC</em> if set to 0.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">cg</span> <span class="op">&lt;-</span> <span class="fu"><a href="coglasso.html">coglasso</a></span><span class="op">(</span><span class="va">multi_omics_sd_micro</span>, pX <span class="op">=</span> <span class="fl">4</span>, nlambda_w <span class="op">=</span> <span class="fl">3</span>, nlambda_b <span class="op">=</span> <span class="fl">3</span>, nc <span class="op">=</span> <span class="fl">3</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Using eXtended Efficient StARS, takes less than five seconds</span></span></span>
<span class="r-in"><span><span class="va">sel_cg_xestars</span> <span class="op">&lt;-</span> <span class="fu">select_coglasso</span><span class="op">(</span><span class="va">cg</span>, method <span class="op">=</span> <span class="st">"xestars"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Using eXtended StARS, takes around a minute</span></span></span>
<span class="r-in"><span><span class="va">sel_cg_xstars</span> <span class="op">&lt;-</span> <span class="fu">select_coglasso</span><span class="op">(</span><span class="va">cg</span>, method <span class="op">=</span> <span class="st">"xstars"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span><span class="co"># Using eBIC</span></span></span>
<span class="r-in"><span><span class="va">sel_cg_xstars</span> <span class="op">&lt;-</span> <span class="fu">select_coglasso</span><span class="op">(</span><span class="va">cg</span>, method <span class="op">=</span> <span class="st">"ebic"</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alessio Albanese, Pariya Behrouzi.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

